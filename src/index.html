<!DOCTYPE html>
<html lang="en">
<head>
	<title>VPWeb</title>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
	<meta name="description" content="Play Visual Pinball in the browser!">
	<link rel="shortcut icon" href="favicon.ico" type="image/x-icon"/>
</head>
<body onkeydown="key(event)" onkeyup="key(event)">

<!-- dmd -->
<canvas id="dmd" width="390" height="102"></canvas>

<!-- emu buttons -->
<div id="emu-buttons">
	<div class="container p-0">
		<div class="row m-2">
			<button class="btn btn-primary btn-sm btn-w1 mr-2" onclick="setCabinetInput(16);">ESC</button>
			<button class="btn btn-primary btn-sm btn-w1" onclick="setCabinetInput(128);">OK</button>
		</div>
		<div class="row m-2">
			<button class="btn btn-primary btn-sm btn-w1 mr-2" onclick="setCabinetInput(32);">&ndash;</button>
			<button class="btn btn-primary btn-sm btn-w1" onclick="setCabinetInput(64);">+</button>
		</div>
		<div class="row m-2">
			<button class="btn btn-primary btn-sm w-100" onclick="setInput(22);">Coin Door</button>
		</div>
	</div>
</div>

<!-- top right close button -->
<button id="close-playfield" type="button" aria-label="Close" onclick="vpw.loader.reset()">
	<span aria-hidden="true">&times;</span>
</button>

<!-- initial drop zone -->
<div id="vpx-drop">
	<div class="modal-guts text-center" ondrop="vpw.loader.dropHandler(event)" ondragenter="vpw.loader.dragEnterHandler(event)" ondragleave="vpw.loader.dragLeaveHandler(event)" ondragover="vpw.loader.dragOverHandler(event)">
		<h1 class="display-4 mt-4">Drag VPX here</h1>
		<p class="lead mt-3">(it's not uploaded anywhere)</p>
	</div>
</div>

<!-- progress modal -->
<div class="modal-overlay closed" id="modal-overlay"></div>
<div class="modal closed" id="progress-modal">
	<div class="modal-guts">
		<div class="spinner"></div>
		<h1 id="progress-header" class="ml-5 mb-3">Loading Table</h1>
		<hr>
		<div id="progress-action1" class="float-left">&nbsp;</div>
		<div id="progress-item1" class="float-right">&nbsp;</div>
		<div class="clearfix"></div>
		<div id="progress-action2" class="float-left"><i>Waiting for web worker to spawn...</i></div>
		<div id="progress-item2" class="float-right">&nbsp;</div>
	</div>
</div>

<script>
	// setup service worker
	if ('serviceWorker' in navigator) {
		window.addEventListener('load', () => navigator.serviceWorker.register('/sw.js'));
	}

	// controls
	function setCabinetInput(key) {
		if (vpw in window && vpw.controller) {
			vpw.controller.setCabinetInput(key);
		}
	}
	function setInput(key) {
		if (vpw in window && vpw.controller) {
			vpw.controller.setInput(key);
		}
	}
	function key(key) {
		if (vpw in window && vpw.controller) {
			vpw.controller.key(key);
		}
	}
</script>

</body>
</html>
